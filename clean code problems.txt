spikewarning and spikes have repeating code
